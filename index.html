<!DOCTYPE html>
<html>
<head>
  <title>Prolog Автомобили с GIF</title>
  <script src="https://unpkg.com/tau-prolog@0.3.1/modules/core.js"></script>
  <script src="https://unpkg.com/tau-prolog@0.3.1/modules/lists.js"></script>
  <style>
    .car-gif { max-height: 200px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Открий автомобил с Prolog</h1>
  <input type="text" id="queryInput" placeholder="Пример: is_electric(X)." size="40">
  <button onclick="runQuery()">Изпълни</button>
  <div id="result"></div>

  <script>
    const knowledge = `
      car(bmw).
      car(tesla).
      car(ford).
      car(toyota).
      car(ferrari).
      car(volvo).

      is_electric(X) :- car(X), member(X, [tesla]).
      is_suv(X) :- car(X), member(X, [volvo, ford]).
      is_sports_car(X) :- car(X), member(X, [ferrari, bmw]).
      is_german(X) :- car(X), member(X, [bmw]).
      is_american(X) :- car(X), member(X, [ford, tesla]).
      is_japanese(X) :- car(X), member(X, [toyota]).
    `;

    const carAnimations = {
      bmw: '<img src="https://media.giphy.com/media/NdKVEei95yvIY/giphy.gif" class="car-gif" alt="BMW" />',
      tesla: '<img src="https://media.giphy.com/media/xT9IgG50Fb7Mi0prBC/giphy.gif" class="car-gif" alt="Tesla" />',
      ford: '<img src="https://media.giphy.com/media/ZHj4rMcPnp2jC/giphy.gif" class="car-gif" alt="Ford" />',
      toyota: '<img src="https://media.giphy.com/media/3o6Ztb7QCMgfT8Zq3C/giphy.gif" class="car-gif" alt="Toyota" />',
      ferrari: '<img src="https://media.giphy.com/media/3ohs4yRJ9ZNL1FkkZC/giphy.gif" class="car-gif" alt="Ferrari" />',
      volvo: '<img src="https://media.giphy.com/media/VbnUQpnihPSIgIXuZv/giphy.gif" class="car-gif" alt="Volvo" />'
    };

    const session = pl.create(1000);
    session.consult(knowledge);

    function runQuery() {
      const query = document.getElementById('queryInput').value;
      document.getElementById('result').innerHTML = 'Търсене...';

      session.query(query);
      session.answers(x => {
        if (x === false) {
          document.getElementById('result').innerHTML = 'Няма резултат.';
        } else {
          const answer = pl.format_answer(x);
          const match = answer.match(/X = (\w+)/);
          if (match && match[1] && carAnimations[match[1]]) {
            document.getElementById('result').innerHTML =
              carAnimations[match[1]] + '<p>' + answer + '</p>';
          } else {
            document.getElementById('result').innerHTML = '<p>' + answer + '</p>';
          }
        }
      });
    }
  </script>
</body>
</html>
